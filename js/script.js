const wrapper=document.querySelector(".wrapper"),musicImg=wrapper.querySelector(".img-area img"),musicName=wrapper.querySelector(".song-details .name"),musicArtist=wrapper.querySelector(".song-details .artist"),playPauseBtn=wrapper.querySelector(".play-pause"),prevBtn=wrapper.querySelector("#prev"),nextBtn=wrapper.querySelector("#next"),mainAudio=wrapper.querySelector("#main-audio"),progressArea=wrapper.querySelector(".progress-area"),progressBar=progressArea.querySelector(".progress-bar"),musicList=wrapper.querySelector(".music-list"),moreMusicBtn=wrapper.querySelector("#more-music"),closemoreMusic=musicList.querySelector("#close");let musicIndex=Math.floor(Math.random()*allMusic.length+1);function loadMusic(e){musicName.innerText=allMusic[e-1].name,musicArtist.innerText=allMusic[e-1].artist,musicImg.src=`img/${allMusic[e-1].src}.png`,mainAudio.src=`music/${allMusic[e-1].src}.mp3`}function playMusic(){wrapper.classList.add("paused"),playPauseBtn.querySelector("i").innerText="pause",mainAudio.play()}function pauseMusic(){wrapper.classList.remove("paused"),playPauseBtn.querySelector("i").innerText="play_arrow",mainAudio.pause()}function prevMusic(){loadMusic(musicIndex=--musicIndex<1?allMusic.length:musicIndex),playMusic(),playingSong()}function nextMusic(){loadMusic(musicIndex=++musicIndex>allMusic.length?1:musicIndex),playMusic(),playingSong()}isMusicPaused=!0,window.addEventListener("load",()=>{loadMusic(musicIndex),playingSong()}),playPauseBtn.addEventListener("click",()=>{wrapper.classList.contains("paused")?pauseMusic():playMusic(),playingSong()}),prevBtn.addEventListener("click",()=>{prevMusic()}),nextBtn.addEventListener("click",()=>{nextMusic()}),mainAudio.addEventListener("timeupdate",e=>{const t=e.target.currentTime;let r=t/e.target.duration*100;progressBar.style.width=`${r}%`;let i=wrapper.querySelector(".current"),a=wrapper.querySelector(".duration");mainAudio.addEventListener("loadeddata",()=>{let e=mainAudio.duration,t=Math.floor(e/60),r=Math.floor(e%60);r<10&&(r=`0${r}`),a.innerText=`${t}:${r}`});let n=Math.floor(t/60),s=Math.floor(t%60);s<10&&(s=`0${s}`),i.innerText=`${n}:${s}`}),progressArea.addEventListener("click",e=>{let t=progressArea.clientWidth,r=e.offsetX,i=mainAudio.duration;mainAudio.currentTime=r/t*i,playMusic(),playingSong()});const repeatBtn=wrapper.querySelector("#repeat-plist");repeatBtn.addEventListener("click",()=>{switch(repeatBtn.innerText){case"repeat":repeatBtn.innerText="repeat_one",repeatBtn.setAttribute("title","Song looped");break;case"repeat_one":repeatBtn.innerText="shuffle",repeatBtn.setAttribute("title","Playback shuffled");break;case"shuffle":repeatBtn.innerText="repeat",repeatBtn.setAttribute("title","Playlist looped")}}),mainAudio.addEventListener("ended",()=>{switch(repeatBtn.innerText){case"repeat":nextMusic();break;case"repeat_one":mainAudio.currentTime=0,loadMusic(musicIndex),playMusic();break;case"shuffle":let e=Math.floor(Math.random()*allMusic.length+1);do{e=Math.floor(Math.random()*allMusic.length+1)}while(musicIndex==e);loadMusic(musicIndex=e),playMusic(),playingSong()}}),moreMusicBtn.addEventListener("click",()=>{musicList.classList.toggle("show")}),closemoreMusic.addEventListener("click",()=>{moreMusicBtn.click()});const ulTag=wrapper.querySelector("ul");for(let e=0;e<allMusic.length;e++){let t=`<li li-index="${e+1}">\n                <div class="row">\n                  <span>${allMusic[e].name}</span>\n                  <p>${allMusic[e].artist}</p>\n                </div>\n                <span id="${allMusic[e].src}" class="audio-duration">3:40</span>\n                <audio class="${allMusic[e].src}" src="music/${allMusic[e].src}.mp3"></audio>\n              </li>`;ulTag.insertAdjacentHTML("beforeend",t);let r=ulTag.querySelector(`#${allMusic[e].src}`),i=ulTag.querySelector(`.${allMusic[e].src}`);i.addEventListener("loadeddata",()=>{let e=i.duration,t=Math.floor(e/60),a=Math.floor(e%60);a<10&&(a=`0${a}`),r.innerText=`${t}:${a}`,r.setAttribute("t-duration",`${t}:${a}`)})}function playingSong(){const e=ulTag.querySelectorAll("li");for(let t=0;t<e.length;t++){let r=e[t].querySelector(".audio-duration");if(e[t].classList.contains("playing")){e[t].classList.remove("playing");let i=r.getAttribute("t-duration");r.innerText=i}e[t].getAttribute("li-index")==musicIndex&&(e[t].classList.add("playing"),r.innerText="Playing"),e[t].setAttribute("onclick","clicked(this)")}}function clicked(e){let t=e.getAttribute("li-index");loadMusic(musicIndex=t),playMusic(),playingSong()}